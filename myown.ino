// O2 Minipops rhythm box (c) DSP Synthesizers 2016
// Free for non commercial use

// http://janostman.wordpress.com


#include <avr/interrupt.h>
#include <avr/io.h>
#include <avr/pgmspace.h>


#ifndef cbi
#define cbi(sfr, bit) (_SFR_BYTE(sfr) &= ~_BV(bit))
#endif
#ifndef sbi
#define sbi(sfr, bit) (_SFR_BYTE(sfr) |= _BV(bit))
#endif 

// Standard Arduino Pins
#define digitalPinToPortReg(P) \
(((P) >= 0 && (P) <= 7) ? &PORTD : (((P) >= 8 && (P) <= 13) ? &PORTB : &PORTC))
#define digitalPinToDDRReg(P) \
(((P) >= 0 && (P) <= 7) ? &DDRD : (((P) >= 8 && (P) <= 13) ? &DDRB : &DDRC))
#define digitalPinToPINReg(P) \
(((P) >= 0 && (P) <= 7) ? &PIND : (((P) >= 8 && (P) <= 13) ? &PINB : &PINC))
#define digitalPinToBit(P) \
(((P) >= 0 && (P) <= 7) ? (P) : (((P) >= 8 && (P) <= 13) ? (P) - 8 : (P) - 14))

#define digitalReadFast(P) bitRead(*digitalPinToPINReg(P), digitalPinToBit(P))
                  
#define digitalWriteFast(P, V) bitWrite(*digitalPinToPortReg(P), digitalPinToBit(P), (V))

const unsigned char PS_128 = (1 << ADPS2) | (1 << ADPS1) | (1 << ADPS0);




//--------- Ringbuf parameters ----------
uint8_t Ringbuffer[256];
uint8_t RingWrite=0;
uint8_t RingRead=0;
volatile uint8_t RingCount=0;
volatile uint16_t SFREQ;
//-----------------------------------------

//Patterns GU BG2 BD CL CW MA CY QU
/*
16 steps
------------
Hard rock
Disco
Reggae
Rock
Samba
Rumba
Cha-Cha
Swing
Bossa Nova
Beguine
Synthpop
12-steps
---------
Boogie
Waltz
Jazz rock
Slow rock
Oxygen
 */

const unsigned char patlen[16] PROGMEM = {15,15,15,15,15,15,15,15,15,15,15,11,11,11,11,11};

const unsigned char pattern[256] PROGMEM = {
  B00101100,      //Hard rock16
  B00000000,
  B00000100,
  B00000000,
  B00101110,
  B00000000,
  B00100100,
  B00000000,
  B00101100,
  B00000000,
  B00000100,
  B00000000,
  B00101110,
  B00000000,
  B00000100,
  B00000000,

  B00100100,      //Disco16
  B00000000,
  B00000100,
  B00010100,
  B00100110,
  B00000000,
  B00000001,
  B00000100,
  B00100100,
  B00000000,
  B00000100,
  B00000100,
  B01100110,
  B00000100,
  B01000001,
  B00000000,

  B01000001,      //Reegae16
  B00000100,
  B10000000,
  B00000000,
  B00010110,
  B00000000,
  B10010000,
  B00000000,
  B00100000,
  B00000000,
  B10010000,
  B00000000,
  B00000110,
  B00000000,
  B10000100,
  B00000000,

  B00100100,      //Rock16
  B00000000,
  B00000100,
  B00000000,
  B00000110,
  B00000000,
  B00100100,
  B00000000,
  B00100100,
  B00000000,
  B00000100,
  B00000000,
  B00000110,
  B00000000,
  B00000110,
  B00000000,

  B10110101,      //Samba16
  B00010100,
  B10000100,
  B00010100,
  B10110100,
  B00000100,
  B01000100,
  B10010100,
  B00100100,
  B10010100,
  B01000100,
  B10010100,
  B10110101,
  B00000100,
  B10010100,
  B00000100,

  B00100110,      //Rumba16
  B00000100,
  B00000001,
  B00110100,
  B00100100,
  B00000001,
  B00010110,
  B00000100,
  B00100100,
  B00000100,
  B00010001,
  B00100100,
  B00110100,
  B00000100,
  B01000001,
  B00000100,

  B00100100,      //Cha-Cha16
  B00000000,
  B00000000,
  B00000000,
  B00000110,
  B00000000,
  B01000000,
  B00000000,
  B00100100,
  B00000000,
  B00000010,
  B00000000,
  B01000101,
  B00000000,
  B00000010,
  B00000000,

  B00100100,      //Swing16
  B00000000,
  B00000000,
  B00000000,
  B00000100,
  B00000000,
  B00000000,
  B00000100,
  B00000100,
  B00000000,
  B00000000,
  B00000000,
  B00000100,
  B00000000,
  B00000000,
  B00000100,

  B00100001,      //Bossa Nova16
  B00000100,
  B00000100,
  B00100100,
  B00100001,
  B00000100,
  B01000100,
  B00000100,
  B00100001,
  B00000100,
  B00000100,
  B00100000,
  B00100001,
  B01000101,
  B00000100,
  B00000100,

  B00100110,      //Beguine16
  B00000000,
  B00000001,
  B00000000,
  B00000100,
  B00000000,
  B01100110,
  B00000000,
  B00100100,
  B00000000,
  B01000100,
  B00000100,
  B00100110,
  B00000000,
  B00000100,
  B00000000,

  B10100000,      //Synthpop16
  B00000000,
  B10100010,
  B00000000,
  B00100000,
  B00000000,
  B00100110,
  B00000100,
  B01100000,
  B00000000,
  B01100110,
  B00000100,
  B00100000,
  B00000000,
  B00100010,
  B10001000,

  B00100000,    //Boogie12
  B00000000,
  B00100100,
  B00000110,
  B00000000,
  B00100100,
  B00100100,
  B00000000,
  B00100100,
  B00000110,
  B00000000,
  B00100100,

  B00000000,
  B00000000,
  B00000000,
  B00000000,

  B00100100,      //Waltz12
  B00000000,
  B00000000,
  B00000000,
  B00010010,
  B00000000,
  B00000000,
  B00000000,
  B00010010,
  B00000000,
  B00000000,
  B00000000,

  B00000000,
  B00000000,
  B00000000,
  B00000000,

  B00100110,      //Jazz rock12
  B00000000,
  B00000100,
  B00000000,
  B00000110,
  B00000000,
  B00000100,
  B00000000,
  B00000110,
  B00000000,
  B01100000,
  B00000000,

  B00000000,
  B00000000,
  B00000000,
  B00000000,

  B00100100,    //Slow rock12
  B00000000,
  B00000100,
  B00000000,
  B00000100,
  B00000000,
  B00000110,
  B00000000,
  B00000100,
  B00000000,
  B00100100,
  B00000000,

  B00000000,
  B00000000,
  B00000000,
  B00000000,

  B00100101,    //Oxygen12
  B00001100,
  B00000100,
  B00101110,
  B00000100,
  B00010100,
  B00100101,
  B00000100,
  B00000100,
  B00101100,
  B00000100,
  B11100100,
  B00000000,
  B00000000,
  B00000000,
  B00000000

};
const unsigned char BD[1076] PROGMEM =
{
126,122,118,114,111,108,105,103,101,99,98,96,95,94,94,93,93,92,92,92,92,92,92,92,92,93,93,93,94,94,95,96,96,97,97,98,99,100,100,101,102,103,103,104,105,106,107,108,108,109,110,111,112,113,113,114,115,116,117,118,118,119,120,121,122,123,124,124,125,126,127,128,129,129,130,131,132,133,134,134,135,136,137,138,138,139,140,141,141,142,143,144,144,145,146,147,
147,148,149,149,150,151,151,152,153,153,154,154,155,156,156,157,157,158,158,159,159,160,160,161,161,162,162,162,163,163,164,164,164,165,165,165,165,166,166,166,166,167,167,167,167,167,167,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,167,167,167,167,167,167,166,166,166,166,165,165,165,165,164,164,164,163,163,163,162,162,161,161,161,160,160,159,159,158,158,157,157,156,156,155,
155,154,154,153,152,152,151,151,150,150,149,148,148,147,146,146,145,144,144,143,142,142,141,140,140,139,138,138,137,136,136,135,134,133,133,132,131,131,130,129,129,128,127,126,126,125,124,124,123,122,122,121,120,120,119,118,118,117,116,116,115,115,114,113,113,112,112,111,110,110,109,109,108,108,107,106,106,105,105,104,104,103,103,102,102,102,101,101,100,100,99,99,99,98,98,97,97,97,96,96,
96,96,95,95,95,94,94,94,94,93,93,93,93,93,93,92,92,92,92,92,92,92,92,92,92,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,92,92,93,93,93,93,93,93,94,94,94,94,95,95,95,95,96,96,96,97,97,97,97,98,98,99,99,99,100,100,100,101,101,102,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,
114,114,115,115,116,117,117,118,118,119,119,120,120,121,121,122,123,123,124,124,125,125,126,127,127,128,128,129,129,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,145,146,146,147,147,147,148,148,148,149,149,149,150,150,150,151,151,151,152,152,152,152,153,153,153,153,153,154,154,154,154,154,155,155,155,155,155,155,155,155,
156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,156,155,155,155,155,155,155,155,155,155,154,154,154,154,153,153,153,153,152,152,152,152,151,151,151,150,150,150,150,149,149,149,148,148,148,147,147,146,146,146,145,145,145,144,144,143,143,143,142,142,141,141,141,140,140,139,139,139,138,138,137,137,137,136,136,135,135,134,134,134,133,133,132,132,132,131,131,130,130,130,129,129,128,
128,128,127,127,126,126,126,125,125,125,124,124,124,123,123,123,122,122,122,121,121,121,120,120,120,119,119,119,119,118,118,118,118,117,117,117,117,116,116,116,116,115,115,115,115,115,115,114,114,114,114,114,114,114,113,113,113,113,113,113,113,113,113,113,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,112,113,113,113,113,113,113,113,113,113,113,
113,114,114,114,114,114,114,114,114,115,115,115,115,115,115,116,116,116,116,116,116,117,117,117,117,117,117,118,118,118,118,118,119,119,119,119,119,120,120,120,120,121,121,121,121,121,122,122,122,122,122,123,123,123,123,124,124,124,124,124,125,125,125,125,125,126,126,126,126,126,127,127,127,127,128,128,128,128,128,128,129,129,129,129,129,130,130,130,130,130,130,131,131,131,131,131,131,132,132,132,
132,132,132,132,133,133,133,133,133,133,133,133,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,136,136,136,136,136,136,136,136,136,136,136,136,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,134,134,134,134,134,134,134,134,134,134,134,134,134,133,133,133,133,133,133,133,133,
133,133,133,133,132,132,132,132,132,132,132,132,132,132,131,131,131,131,131,131,131,131,131,131,131,130,130,130,130,130,130,130,130,130,130,130,130,129,129,129,129,129,129,129,129,129,129,129,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
127,127,127,127,126,126,126,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
}; 
const unsigned char BG2[1136] PROGMEM =
{
  128,122,108,96,86,80,78,79,82,89,98,108,119,131,143,155,167,178,188,198,206,212,217,220,222,221,219,215,210,203,195,185,174,162,149,136,122,108,94,80,67,54,42,32,23,15,9,5,2,1,2,5,11,16,23,32,43,54,67,80,95,109,124,138,153,166,179,192,203,213,221,228,234,238,240,240,239,236,232,226,219,211,201,191,179,167,155,142,129,117,104,92,81,71,62,54,
  48,43,39,37,36,37,40,43,49,55,63,72,82,92,103,115,127,138,150,161,172,182,191,199,206,212,217,220,221,222,221,219,215,210,204,197,188,179,170,159,149,138,127,116,105,95,85,76,68,61,55,50,47,45,44,44,46,49,53,59,65,73,81,90,99,109,119,129,139,149,158,167,175,182,189,194,198,201,203,204,204,202,199,196,191,185,178,171,163,154,145,136,127,117,108,99,91,83,76,70,
  65,61,57,55,54,54,55,58,61,66,71,77,84,91,99,108,116,125,134,142,150,158,165,172,178,182,186,190,192,193,193,192,190,187,183,178,173,167,160,153,146,138,130,122,115,107,100,93,87,81,77,73,70,67,66,66,66,68,71,74,78,83,88,95,101,108,115,123,130,137,144,151,157,163,168,173,177,180,182,183,184,184,182,180,178,174,170,165,159,154,147,141,134,128,121,115,109,103,97,92,
  88,84,81,79,77,76,76,77,79,81,85,88,93,98,103,109,115,121,127,133,139,145,150,156,160,164,168,171,173,175,176,176,175,174,172,169,166,162,158,153,148,143,137,132,126,120,115,110,105,100,96,93,90,88,86,85,85,85,86,88,90,93,96,100,104,109,114,119,124,129,134,139,144,149,153,157,160,163,165,167,168,168,168,167,166,164,162,159,156,152,148,143,139,134,129,125,120,115,111,107,
  103,100,97,95,93,92,92,91,92,93,95,97,99,102,106,109,113,118,122,126,131,135,139,143,147,150,153,156,158,160,161,162,162,162,161,160,158,156,153,150,147,143,139,136,131,128,124,120,116,112,109,106,104,101,100,98,98,97,97,98,99,100,102,105,107,110,113,117,120,124,128,131,135,139,142,145,148,150,152,154,155,156,157,157,156,155,154,153,151,148,146,143,140,136,133,130,126,123,120,117,
  114,111,109,107,105,104,103,102,102,102,103,104,105,107,109,111,114,117,120,123,126,129,132,135,138,141,143,145,147,149,150,151,152,152,152,152,151,150,148,146,144,142,139,137,134,131,128,126,123,120,117,115,113,111,109,108,107,106,106,106,106,107,108,109,111,113,115,117,119,122,124,127,130,132,135,137,139,141,143,145,146,147,148,148,148,148,148,147,146,144,143,141,139,137,135,132,130,127,125,123,
  120,118,116,115,113,112,111,110,110,109,109,110,110,111,113,114,116,117,119,121,124,126,128,130,132,134,136,138,140,141,142,144,144,145,145,145,145,144,144,143,141,140,138,137,135,133,131,129,127,125,123,121,119,118,116,115,114,113,113,112,112,112,113,113,114,115,116,118,119,121,123,125,127,128,130,132,134,135,137,138,139,140,141,142,142,142,142,142,141,141,140,139,137,136,135,133,131,130,128,126,
  125,123,121,120,119,118,117,116,115,115,115,115,115,115,116,117,118,119,120,121,123,124,126,128,129,130,132,133,135,136,137,138,139,139,140,140,140,140,140,139,138,138,137,136,134,133,132,130,129,128,126,125,123,122,121,120,119,118,118,117,117,117,117,117,117,118,119,120,121,122,123,124,125,127,128,129,131,132,133,134,135,136,137,137,138,138,138,138,138,138,137,137,136,135,134,133,132,131,130,128,
  127,126,125,124,123,122,121,120,120,119,119,119,119,119,119,119,120,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,135,136,136,136,137,137,136,136,136,135,134,134,133,132,131,130,129,128,127,126,125,124,123,122,122,121,121,120,120,120,120,120,120,121,121,122,122,123,124,125,126,127,128,129,129,130,131,132,133,133,134,134,135,135,135,135,135,135,135,134,134,133,132,132,131,130,129,
  128,128,127,126,125,124,124,123,123,122,122,121,121,121,121,121,122,122,122,123,124,124,125,126,126,127,128,129,130,130,131,132,132,133,133,134,134,134,134,134,134,134,134,133,133,132,132,131,130,130,129,128,127,127,126,125,125,124,124,123,123,123,122,122,122,122,123,123,123,124,124,124,125,126,126,127,128,128,129,130,130,131,131,132,132,133,133,133,133,133,133,133,133,133,132,132,131,131,130,130,
  129,129,128,127,127,126,126,125,125,124,124,124,123,123,123,123,123,123,124,124,124,125,125,126,126,127,127,128,128,129,130,130,130,131,131,132,132,132,132,132,132,132,132,132,132,131,131,131,130,130,129,129,128,128,127,127,126,126,125,125,125,125,124,124,124,124,124,124,125,125,125,125,126,126,126,127,127,128,128,128,129,129,129,130,130,130,130,130,131,131,131,131,131,130,130,130,130,130,129,129,
  129,129,128,128,128,128,127,127,127,127,127,126,126,126,126,126,126,126,126,127,127,127,127,127,127,127,128,128,128,128,128,128,129,129,129,129,129,129,129,128,
};

const unsigned char CL[752] PROGMEM =
{
  125,82,65,93,135,172,181,161,118,74,48,54,88,139,184,207,199,166,124,92,86,109,150,192,217,215,187,146,108,90,100,130,166,191,194,171,132,93,68,68,90,123,151,160,147,115,80,54,50,68,100,132,150,147,125,96,72,66,80,111,144,167,172,158,133,109,99,107,132,162,186,194,183,159,132,116,116,131,156,177,185,176,152,124,103,96,105,125,144,154,149,130,104,83,74,80,
  98,119,134,135,123,103,84,76,81,99,122,141,148,142,127,111,102,105,121,142,161,171,168,154,137,125,123,133,149,166,175,172,158,139,123,116,119,131,145,153,151,138,120,104,94,95,105,119,129,130,123,108,94,86,87,98,113,126,132,130,120,109,102,103,113,129,143,152,152,144,134,126,125,131,143,156,164,164,156,144,133,127,130,137,147,153,152,144,131,119,111,110,115,124,130,131,125,115,103,96,
  96,101,111,120,124,122,116,108,102,102,109,120,130,137,139,134,128,123,122,128,137,147,153,155,150,143,136,133,134,140,147,152,152,147,138,129,123,122,125,130,134,134,130,122,113,107,105,108,114,120,122,120,115,109,104,104,108,115,123,128,129,126,122,119,119,123,130,138,144,145,143,139,135,133,135,140,146,150,150,147,141,135,131,130,132,136,138,138,134,128,121,116,115,116,119,122,123,121,117,112,
  108,107,110,114,119,123,123,121,118,116,116,119,125,131,135,137,136,133,131,131,133,137,142,145,146,145,141,137,135,135,136,139,141,141,138,133,128,124,123,123,125,127,127,124,121,116,113,112,113,116,119,120,120,119,116,114,115,117,121,125,129,130,130,128,127,127,130,133,137,140,142,141,139,137,135,136,138,140,142,141,140,136,133,130,129,129,130,131,130,128,125,121,118,117,117,119,120,121,120,118,
  116,115,115,116,119,122,124,125,125,124,123,124,126,129,132,135,136,136,135,134,134,135,137,139,140,140,139,137,135,133,132,133,133,134,133,131,129,126,123,122,122,122,123,123,122,120,118,116,116,117,118,120,122,122,122,121,121,121,123,125,128,130,131,131,131,131,131,132,134,136,138,138,138,136,135,134,134,134,135,135,135,133,131,129,127,126,126,126,126,125,124,122,121,119,118,119,119,120,121,121,
  120,120,119,120,121,122,124,126,127,127,127,127,128,129,131,133,134,135,135,134,134,134,134,135,135,136,135,135,133,132,130,129,129,129,129,128,127,125,124,122,121,121,121,122,122,121,121,120,119,119,120,121,122,123,124,124,124,125,125,127,128,130,131,132,132,132,132,132,133,134,135,135,135,135,134,133,132,132,131,131,131,130,129,128,127,125,125,124,124,124,124,123,122,121,120,120,121,121,122,122,
  123,123,123,123,124,125,126,127,128,129,129,130,130,130,131,132,133,134,134,134,133,133,133,133,133,133,132,132,131,130,129,128,127,127,127,126,126,125,124,123,122,122,122,122,122,123,123,122,122,122,123,123,124,125,126,127,127,127,128,128,129,130,131,132,132,132,132,132,132,132,133,133,133,132,132,131,130,130,129,129,129,128,128,127,127,126,125,125,125,125,125,125,125,124,124,124,124,125,125,126,
  126,126,126,127,127,127,128,128,129,129,129,129,129,129,129,130,130,130,130,130,130,130,129,129,129,129,129,129,128,128,128,128,128,128,127,127,127,127,127,127,127,127,127,127,127,128,128,128,128,128,128,128,128,128,128,128,
};

const unsigned char CW[830] PROGMEM =
{
  155,223,121,59,131,200,124,42,93,189,170,83,95,187,206,125,96,165,207,143,82,122,178,140,68,80,143,138,74,64,128,153,107,81,133,178,148,109,137,187,172,122,124,167,167,115,96,130,145,105,76,103,134,113,82,102,142,140,111,118,157,167,138,128,157,171,144,120,134,151,130,100,105,127,119,92,92,119,127,108,105,131,148,136,126,144,164,154,135,141,156,148,124,119,131,129,
  108,98,111,119,106,98,112,128,125,117,128,147,149,138,141,155,157,142,134,141,142,127,114,117,122,112,100,104,115,115,108,113,128,134,130,132,145,152,146,141,147,151,142,131,130,132,124,112,110,114,113,105,105,114,120,118,120,130,139,139,138,144,151,149,142,141,143,138,128,122,123,120,112,107,110,113,111,110,116,124,127,128,134,142,145,143,144,147,147,141,135,134,132,124,117,116,115,112,108,109,
  114,116,117,121,129,134,135,138,143,147,145,143,143,142,137,131,127,125,120,114,112,112,112,111,112,117,121,124,127,133,138,140,141,144,146,144,141,138,136,132,126,121,119,116,113,111,112,114,114,116,121,126,130,133,137,141,143,143,143,143,141,137,133,130,126,122,117,115,114,112,112,113,116,119,122,126,131,135,137,140,143,144,143,141,139,137,133,128,124,121,118,115,113,113,114,114,117,120,124,128,
  131,135,139,141,142,142,142,141,138,135,131,128,123,120,117,115,114,113,114,116,118,121,125,129,133,135,138,141,142,142,141,139,137,133,130,126,123,120,117,115,114,114,115,117,120,123,126,130,134,137,139,140,141,141,140,138,135,132,129,125,122,119,117,115,114,115,116,118,121,124,128,131,134,137,139,140,141,140,139,137,134,131,128,124,121,119,117,116,115,116,117,119,122,125,129,132,135,137,139,140,
  140,140,138,136,133,130,127,123,121,118,116,116,116,117,118,121,123,126,130,133,135,138,139,140,140,139,137,135,132,129,126,123,120,118,117,116,116,117,119,122,124,128,131,133,136,138,139,139,139,138,136,133,131,128,125,122,119,118,117,116,117,118,120,123,125,128,131,134,136,138,139,139,138,137,135,132,129,127,124,121,119,118,117,117,118,119,121,124,127,129,132,135,137,138,138,138,137,136,134,131,
  128,126,123,121,119,118,117,118,119,120,122,125,128,130,133,135,137,138,138,138,137,135,133,130,127,125,122,120,119,118,118,118,119,121,123,126,129,131,134,135,137,138,138,137,136,134,132,129,126,124,122,120,119,118,118,119,120,122,124,127,129,132,134,136,137,137,137,136,135,133,131,128,126,123,121,120,119,118,119,120,121,123,125,128,130,132,134,136,137,137,136,135,134,132,129,127,125,123,121,119,
  119,119,119,120,122,124,126,129,131,133,135,136,136,136,136,135,133,131,128,126,124,122,120,119,119,119,120,121,123,125,127,129,132,133,135,136,136,136,135,134,132,130,128,125,123,121,120,119,119,119,120,122,124,126,128,130,132,134,135,136,136,135,134,133,131,129,127,125,123,121,120,119,119,120,121,123,125,127,129,131,133,134,135,136,135,135,134,132,130,128,126,124,122,121,120,120,120,121,122,124,
  126,128,130,132,133,134,135,135,135,134,133,131,129,127,125,123,122,121,120,120,121,122,123,125,127,128,130,132,133,134,134,134,134,133,131,130,128,127,125,124,123,122,122,122,123,124,125,126,127,129,130,131,132,133,133,132,132,131,130,129,128,127,126,125,124,124,124,124,125,125,126,127,128,129,130,131,131,131,131,131,130,130,129,128,128,127,126,126,125,125,125,126,126,127,127,128,128,129,129,130,
  130,130,130,129,129,129,128,128,128,127,127,127,127,127,127,127,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
};

const unsigned char CY[1462] PROGMEM =
{
  63130,63129,2992,2994,61953,61951,4637,4640,59012,59009,43927,43928,9670,9671,61482,61480,65126,65128,4308,4307,1202,1202,374,375,2917,2916,3759,3758,266,269,282,279,10128,10130,64673,64672,55105,55105,58180,58181,55913,55912,11483,11483,8353,8354,3977,3976,6780,6782,10571,10568,19480,19482,12015,12015,1993,1992,62758,62760,60224,60222,58847,58847,59694,59696,58670,58667,60936,60939,57006,57005,2354,2353,10128,10128,3515,3517,10433,10430,3970,3974,57410,57406,10024,10027,18193,18190,7026,7030,18426,18421,4912,4916,11439,11437,1858,1859,56048,56047,57795,57796,53511,53509,3049,3052,117,115,2761,2762,64163,64161,1620,1623,59678,59674,6905,6911,13523,13517,59295,59299,64279,64277,56807,56806,57569,57571,56192,56191,52937,52937,59079,59080,56159,56157,5578,5580,3425,3422,642,646,6732,6729,65045,65047,58955,58953,62815,62816,64088,64088,62768,62768,60631,60631,58136,58135,61492,61493,57002,57002,62688,62688,64655,64655,62357,62356,61287,61289,61955,61953,58981,58982,1192,1192,607,607,1040,1041,6213,6211,60155,60156,62271,62270,61853,61854,61932,61933,991,989,64269,64271,5126,5123,5202,5204,63726,63726,2309,2308,1299,1300,1928,1927,59393,59393,6726,6727,18582,18580,1249,1251,61866,61864,420,423,456,452,1557,1560,652,650,62348,62349,65087,65087,2494,2493,62350,62351,60715,60714,63128,63128,62814,62816,5598,5595,60753,60756,63609,63606,65327,65330,64604,64602,1229,1230,64416,64416,65134,65133,59224,59226,
55268,55267,59509,59508,6701,6703,4092,4089,2349,2353,1149,1145,509,512,469,467,374,376,63732,63730,63306,63307,61842,61840,64459,64462,61244,61241,1546,1549,63296,63294,6313,6313,12020,12022,64603,64599,2589,2595,62831,62824,63092,63099,61624,61618,62657,62661,63359,63358,311,311,2676,2675,9632,9633,115,114,64493,64494,1285,1286,23,20,432,434,65368,65368,63891,63889,65033,65036,603,600,60587,60589,1072,1070,65456,65459,63652,63648,63782,63786,697,693,61300,61303,63945,63943,63860,63862,64784,64782,62977,62979,61194,61192,2164,2165,1329,1330,2495,2493,1689,1691,912,911,64951,64952,65137,65135,62702,62704,56243,56241,61313,61315,1202,1201,3348,3348,2956,2956,1031,1030,65492,65494,62774,62772,60083,60085,62161,62160,63808,63808,62561,62561,3696,3695,545,548,64892,64888,2764,2769,62537,62531,63286,63290,61695,61694,62333,62333,1025,1027,172,168,2386,2389,64243,64243,1953,1952,60092,60094,2653,2651,2689,2690,62636,62636,4927,4927,58030,58029,65260,65262,2805,2803,62757,62759,64241,64238,300,302,384,384,3305,3304,5108,5110,2907,2904,64574,64576,65288,65288,64778,64776,60044,60048,62533,62527,65316,65323,61380,61373,62730,62737,64943,64937,1443,1447,65480,65478,65406,65407,64624,64625,63761,63758,4653,4655,65494,65494,723,722,65244,65247,64090,64085,63706,63711,1111,1106,626,631,65109,65104,453,457,535,533,1212,1213,2045,2045,3101,3100,63542,63542,1169,1171,841,839,
783,784,678,677,64081,64082,65105,65105,64564,64565,62189,62187,63660,63660,63398,63400,65374,65372,197,200,64413,64409,1561,1564,3623,3621,1594,1595,135,136,289,285,63084,63089,1955,1950,63834,63837,424,424,493,491,63411,63414,1519,1516,1344,1345,2590,2591,2284,2282,1712,1715,888,886,1117,1117,63939,63940,64244,64241,63357,63361,64331,64329,181,182,447,446,2340,2341,2862,2860,2793,2796,2705,2702,2415,2417,1018,1019,802,799,63252,63255,62898,62895,63251,63254,63414,63413,64292,64291,1983,1984,3801,3801,3034,3034,2817,2818,1659,1657,427,429,1141,1140,63802,63801,61808,61810,538,535,64416,64420,65265,65263,64953,64952,64006,64009,65370,65365,1496,1502,1394,1388,1081,1087,2169,2165,1112,1113,1342,1344,236,232,130,135,195,190,64947,64950,64691,64689,682,685,509,506,334,336,704,702,1262,1264,1662,1661,1440,1440,1074,1074,1153,1153,459,461,65070,65066,810,813,484,482,65073,65075,428,427,853,853,996,995,1053,1054,1482,1482,2053,2053,65529,65529,576,575,64556,64558,63329,63328,63882,63882,64272,64272,512,512,88,89,64153,64151,65172,65174,129,126,422,426,3876,3873,3020,3019,1789,1793,2074,2068,1424,1430,1633,1629,64822,64823,63296,63298,63987,63982,63731,63738,64158,64151,64872,64877,65152,65151,65513,65510,959,964,762,757,1406,1410,405,402,64452,64454,470,468,310,312,34,34,845,843,
522,525,535,531,127,131,65400,65398,1206,1207,1156,1155,111,112,65032,65031,416,418,730,728,203,205,90,87,65379,65382,561,558,813,817,466,464,799,799,350,349,65422,65424,295,292,65144,65149,64564,64559,340,343,65220,65219,64505,64505,673,673,589,589,372,371,895,898,65531,65528,988,990,1642,1640,425,426,545,547,64746,64743,64430,64432,64997,64995,65422,65424,378,378,645,644,172,174,65433,65428,729,735,797,793,64,66,65076,65077,1393,1390,764,766,94,94,525,524,86,88,46,43,65013,65016,235,234,446,445,377,379,510,507,271,273,64772,64772,64843,64841,65012,65016,65217,65213,570,571,200,201,893,891,1168,1170,831,830,555,555,646,647,186,185,65144,65143,64550,64552,65012,65011,255,255,65149,65151,379,375,255,259,260,256,373,377,768,765,551,553,65226,65225,65317,65317,65431,65432,429,429,423,423,65420,65418,64242,64245,64227,64225,65233,65234,93,95,1,65532,640,646,428,422,65177,65182,291,286,1045,1050,1143,1141,229,227,65421,65426,405,397,759,768,211,204,65036,65040,64937,64936,64944,64943,64460,64463,64297,64293,65177,65180,65334,65332,42,43,665,665,560,561,136,133,474,478,166,162,65266,65268,65393,65393,65005,65004,64303,64305,65058,65056,65466,65467,64798,64797,65289,65290,64924,64925,1264,1260,1118,1124,66,59,
586,592,64943,64940,64739,64739,64856,64857,64854,64853,65367,65368,365,364,65298,65298,65284,65285,311,309,545,548,496,492,47,50,65281,65280,65197,65196,65319,65321,65532,65530,394,396,688,686,557,559,605,601,396,403,65238,65231,64762,64767,65060,65057,64787,64788,64924,64925,283,280,65138,65142,65396,65393,65282,65284,65267,65267,563,560,110,114,748,744,1108,1111,181,180,197,196,710,712,287,284,65444,65447,283,281,65371,65372,64957,64956,65531,65532,65291,65290,65407,65409,167,164,290,294,65498,65494,65189,65192,59,57,362,363,416,416,499,500,385,382,440,443,430,429,65096,65095,538,540,100,98,122,124,65330,65328,65496,65498,577,575,435,435,640,643,65353,65348,65220,65226,64899,64894,65514,65517,65145,65143,33,34,65483,65484,7,6,65510,65510,326,326,1009,1009,717,717,630,632,100,96,169,173,253,250,65255,65256,64958,64959,64666,64664,64823,64825,245,244,65363,65363,218,218,182,183,107,105,270,273,186,183,65462,65465,152,149,15,18,196,193,408,410,48,47,161,161,65276,65277,410,409,129,129,188,188,508,509,489,487,147,150,65440,65437,65532,65534,175,174,230,231,65247,65246,65360,65362,65274,65270,164,169,203,198,479,483,100,98,65512,65513,205,204,65208,65208,2,2,65479,65479,65498,65500,479,476,132,134,65417,65417,
65437,65436,65211,65212,308,309,77,73,224,231,65472,65463,164,172,65358,65352,64933,64938,227,224,65423,65422,65492,65494,65334,65333,65489,65489,65496,65499,49,42,65453,65460,28,23,65508,65511,65327,65326,192,191,65529,65531,65177,65174,65433,65437,65484,65480,65300,65302,65226,65228,65372,65368,95,98,65370,65368,65241,65241,65412,65414,84,82,54,55,21,19,65491,65494,187,183,172,176,40,37,65505,65507,65478,65476,65080,65083,65234,65231,185,187,65464,65463,64972,64972,65324,65325,65491,65491,65217,65215,65263,65265,65155,65153,23,26,165,163,187,188,257,256,368,370,65511,65508,65534,2,65451,65447,161,164,86,85,65399,65399,237,237,65490,65490,65401,65401,65514,65515,65440,65438,65246,65248,80,79,134,135,176,176,10,8,65332,65334,65293,65293,65139,65139,65261,65260,4,4,78,77,65456,65460,215,210,255,259,50,47,7,8,65431,65432,65525,65524,30,29,56,59,65460,65457,65526,65527,35,37,65511,65508,

};

const unsigned char GU[2816] PROGMEM =
{
  129,128,128,128,128,129,127,125,60,183,220,111,65,98,159,157,127,106,121,136,139,125,122,125,132,130,128,125,128,128,130,127,128,127,129,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,128,127,128,127,129,127,129,127,129,127,129,127,
  129,127,129,127,129,127,129,126,129,126,130,126,130,125,133,112,60,206,200,99,63,110,162,153,120,106,125,138,137,124,122,126,132,130,128,125,128,128,129,127,128,127,129,128,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,
  128,127,128,127,129,127,129,127,129,126,130,126,130,125,132,124,133,120,142,77,106,232,156,76,70,137,162,142,108,112,130,140,131,122,122,129,131,129,126,126,128,129,128,127,127,128,128,128,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,127,128,127,129,127,129,127,129,126,129,126,131,125,131,124,133,119,141,77,111,235,153,76,72,138,162,142,109,113,130,141,131,122,122,130,131,129,126,126,128,129,128,127,127,128,128,128,128,127,128,128,128,127,128,128,128,128,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,
  128,127,128,127,128,127,128,127,129,127,129,127,129,127,129,126,129,126,130,126,130,125,131,124,133,122,137,96,76,225,182,88,65,123,163,149,115,109,127,140,134,123,122,127,132,129,127,126,128,129,129,127,128,127,129,128,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,128,128,128,127,128,127,128,
  127,128,127,128,127,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,127,129,127,129,126,130,125,131,123,137,57,149,228,128,67,83,151,159,133,105,118,134,140,127,122,123,131,130,129,125,127,128,129,127,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,
  128,127,128,127,128,127,128,127,128,127,128,127,128,127,129,127,128,127,129,127,129,127,129,126,129,127,129,126,129,126,129,126,130,125,132,114,65,203,204,99,63,109,161,154,121,106,124,138,137,124,122,126,132,129,128,125,128,128,129,127,128,127,129,128,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,128,127,128,127,129,127,129,127,129,126,130,125,131,124,134,120,139,72,117,238,149,74,74,142,162,140,108,114,131,141,130,122,122,130,131,129,126,127,128,129,128,127,127,128,128,128,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,127,128,127,128,127,128,127,128,127,129,127,129,127,129,127,129,127,129,127,129,127,129,127,129,127,129,127,129,126,131,120,60,196,206,102,61,105,160,154,122,105,123,137,138,124,122,125,132,130,128,125,128,128,129,127,128,127,129,128,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,129,127,129,127,129,126,129,126,130,125,131,124,133,119,142,74,118,234,148,74,74,141,162,141,108,114,131,141,130,122,122,130,131,129,126,127,128,129,128,127,127,128,128,128,128,127,128,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
};


const unsigned char MA[568] PROGMEM =
{
  127,124,134,122,131,126,127,126,129,124,134,127,125,130,123,131,121,146,117,130,123,134,127,135,116,137,123,138,131,108,143,121,133,125,131,122,133,135,114,137,120,127,144,116,129,139,113,143,122,126,130,125,123,133,132,127,116,131,145,108,139,131,122,136,126,123,115,141,142,108,138,114,147,111,133,131,129,120,121,137,136,124,127,130,129,118,127,129,137,131,118,143,114,132,123,142,
  121,116,140,122,125,132,134,124,129,128,110,145,143,108,135,131,121,128,118,146,125,122,129,127,127,128,137,127,124,132,123,140,111,130,129,127,138,121,124,132,139,119,130,128,136,119,130,127,126,137,125,126,124,125,125,134,130,127,131,124,119,138,131,122,126,126,146,113,126,132,129,130,121,132,128,133,119,133,136,120,132,121,128,133,130,119,136,134,111,146,108,139,140,116,136,126,129,123,130,125,
  125,139,125,130,119,132,129,124,129,129,130,122,136,116,144,117,130,137,131,117,126,139,126,121,130,129,131,133,122,127,124,136,126,133,128,124,129,130,131,121,129,130,132,128,125,122,128,139,122,127,134,130,118,136,130,123,123,127,140,121,128,136,123,125,136,121,134,126,129,129,127,129,132,127,126,132,113,140,127,128,133,127,126,127,125,130,131,131,121,135,126,126,127,131,131,126,131,122,130,125,
  136,124,129,129,126,129,128,127,129,129,128,125,133,128,127,122,137,126,126,128,125,134,128,129,125,133,123,125,138,125,125,133,128,125,130,129,124,130,124,134,130,128,127,127,125,134,124,131,129,127,133,120,129,132,126,129,129,129,128,126,130,127,128,127,130,127,132,126,125,133,127,127,130,129,126,127,130,128,130,130,128,125,129,128,130,125,131,130,124,130,128,130,126,131,126,130,123,131,128,131,
  128,128,129,126,132,124,131,128,130,127,129,121,135,127,127,127,130,127,129,130,128,128,127,130,127,127,126,133,125,128,131,127,127,129,127,130,126,130,127,132,123,130,128,130,128,125,131,125,130,129,127,128,129,127,129,126,130,130,128,128,127,129,128,127,130,128,127,127,130,128,129,127,126,130,128,127,128,127,128,131,126,130,127,127,130,124,134,126,127,130,127,129,127,129,127,128,128,128,128,127,
  129,130,126,127,129,127,129,130,125,129,127,129,127,129,128,127,129,125,128,129,130,127,129,127,128,128,129,126,130,127,127,128,127,130,126,126,131,128,126,130,127,130,126,127,129,128,128,127,128,128,128,127,128,128,129,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
};

const unsigned char QU[7712] PROGMEM =
{
  128,129,131,132,137,169,173,141,100,73,75,103,141,167,170,149,119,96,92,107,132,151,157,146,126,109,104,111,127,142,148,142,130,117,111,115,125,135,141,139,131,122,117,118,124,132,136,136,131,125,121,121,125,130,133,133,131,127,124,123,125,128,131,132,130,128,125,125,126,128,130,131,130,128,126,126,126,128,129,130,129,128,127,126,127,128,129,129,129,128,127,127,127,128,128,129,
  129,128,128,127,127,128,128,128,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,129,128,129,127,129,127,130,126,173,207,141,59,15,41,112,182,210,187,134,87,74,97,138,168,172,150,135,135,122,110,104,110,123,137,144,142,132,121,115,116,124,133,139,138,133,125,120,120,124,130,135,135,132,127,123,122,125,129,132,133,131,128,125,
  124,126,128,130,131,131,129,127,126,126,128,129,130,130,129,127,127,127,128,129,130,129,129,128,127,127,128,129,129,129,129,128,127,128,128,129,129,129,129,128,128,128,128,128,129,129,129,128,128,128,128,128,129,129,129,129,128,128,128,128,128,129,129,129,128,128,128,128,128,128,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,127,128,129,129,129,128,128,127,127,128,128,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,129,128,129,128,129,127,130,128,192,216,132,41,1,40,122,199,219,186,124,76,67,100,144,173,171,144,112,96,102,124,145,154,145,128,114,110,119,132,140,141,133,124,119,120,126,133,135,133,128,124,123,125,129,132,132,130,127,125,126,127,130,130,130,128,127,127,127,128,129,129,129,128,
  128,127,128,128,129,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,119,115,127,140,147,142,130,118,115,119,129,136,137,133,126,121,121,125,130,133,132,129,126,124,125,128,130,131,130,128,126,126,127,129,130,130,129,128,127,127,128,129,129,129,128,128,127,128,128,129,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,129,131,174,176,120,67,50,82,134,176,183,157,118,93,94,117,143,157,152,134,115,108,114,129,141,144,136,126,118,118,124,132,136,135,130,124,122,124,128,132,132,130,127,125,125,127,129,130,130,129,127,126,127,128,129,129,129,128,127,127,127,128,129,129,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,124,124,129,133,135,
  132,127,124,124,126,129,131,131,129,127,126,126,128,129,130,129,128,127,127,128,129,129,129,129,128,127,128,128,129,129,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,129,127,139,164,147,109,82,84,111,144,163,158,136,113,104,111,128,142,147,139,126,117,116,123,132,137,136,130,124,121,123,128,132,133,131,128,125,124,126,129,131,130,129,127,126,127,128,129,130,129,128,127,127,127,128,129,129,128,128,127,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,127,128,129,129,129,128,128,127,128,128,129,129,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,131,151,147,121,98,94,110,134,151,152,139,121,112,114,125,136,142,138,129,121,119,123,130,134,135,131,126,123,124,127,130,132,131,128,126,125,127,128,130,130,129,128,127,127,128,129,129,129,128,128,127,128,128,129,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,131,144,140,
  122,108,106,117,133,144,144,134,123,117,119,127,134,137,134,128,123,122,125,130,132,133,130,127,125,125,127,130,131,130,128,127,126,127,128,129,129,129,128,127,127,128,129,129,129,128,128,128,128,128,129,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,132,140,133,121,113,115,124,134,139,137,130,123,121,
  123,129,133,134,131,127,124,124,127,130,131,131,129,127,126,127,128,129,130,129,128,127,127,128,129,129,129,128,128,127,128,128,128,129,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,133,135,128,121,118,121,128,134,135,132,127,124,123,126,130,132,131,129,126,125,126,128,130,
  130,129,128,127,127,127,128,129,129,128,128,127,127,128,128,129,128,128,127,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,130,133,130,125,122,122,126,130,133,132,129,126,125,126,128,130,130,129,128,126,126,127,129,129,129,128,127,127,127,128,129,129,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
  128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,128,
};

ISR(TIMER1_COMPA_vect) {
  
    //-------------------  Ringbuffer handler -------------------------
    
    if (RingCount) {                            //If entry in FIFO..
      OCR2A = Ringbuffer[(RingRead++)];          //Output LSB of 16-bit DAC
      RingCount--;
    }
    
    //-----------------------------------------------------------------

}



void setup() {
  
    OSCCAL=0xFF;
    
    //Drum mute inputs
    pinMode(2,INPUT_PULLUP);
    pinMode(3,INPUT_PULLUP);
    pinMode(4,INPUT_PULLUP);
    pinMode(5,INPUT_PULLUP);
    pinMode(6,INPUT_PULLUP);
    pinMode(7,INPUT_PULLUP);
    pinMode(8,INPUT_PULLUP);
    pinMode(9,INPUT_PULLUP);

    pinMode(10,INPUT_PULLUP); //RUN - Stop input
    pinMode(12,OUTPUT);       //Reset output
    pinMode(13,OUTPUT);       //Clock output

    pinMode(14,OUTPUT);       //SEQ cnt output
    pinMode(15,OUTPUT); 
    pinMode(16,OUTPUT); 
    pinMode(17,OUTPUT); 
    
    //8-bit PWM DAC pin
    pinMode(11,OUTPUT);

    // Set up Timer 1 to send a sample every interrupt.
    cli();
    // Set CTC mode
    // Have to set OCR1A *after*, otherwise it gets reset to 0!
    TCCR1B = (TCCR1B & ~_BV(WGM13)) | _BV(WGM12);
    TCCR1A = TCCR1A & ~(_BV(WGM11) | _BV(WGM10));    
    // No prescaler
    TCCR1B = (TCCR1B & ~(_BV(CS12) | _BV(CS11))) | _BV(CS10);
    // Set the compare register (OCR1A).
    // OCR1A is a 16-bit register, so we have to do this with
    // interrupts disabled to be safe.
    //OCR1A = F_CPU / SAMPLE_RATE; 
    // Enable interrupt when TCNT1 == OCR1A
    TIMSK1 |= _BV(OCIE1A);   
    sei();
    OCR1A = 800; //40KHz Samplefreq

// Set up Timer 2 to do pulse width modulation on D11

    // Use internal clock (datasheet p.160)
    ASSR &= ~(_BV(EXCLK) | _BV(AS2));

    // Set fast PWM mode  (p.157)
    TCCR2A |= _BV(WGM21) | _BV(WGM20);
    TCCR2B &= ~_BV(WGM22);

    // Do non-inverting PWM on pin OC2A (p.155)
    // On the Arduino this is pin 11.
    TCCR2A = (TCCR2A | _BV(COM2A1)) & ~_BV(COM2A0);
    TCCR2A &= ~(_BV(COM2B1) | _BV(COM2B0));
    // No prescaler (p.158)
    TCCR2B = (TCCR2B & ~(_BV(CS12) | _BV(CS11))) | _BV(CS10);

    // Set initial pulse width to the first sample.
    OCR2A = 128;

    //set timer0 interrupt at 61Hz
    TCCR0A = 0;// set entire TCCR0A register to 0
    TCCR0B = 0;// same for TCCR0B
    TCNT0  = 0;//initialize counter value to 0
    // set compare match register for 62hz increments
    OCR0A = 255;// = 61Hz
    // turn on CTC mode
    TCCR0A |= (1 << WGM01);
    // Set CS01 and CS00 bits for prescaler 1024
    TCCR0B |= (1 << CS02) | (0 << CS01) | (1 << CS00);  //1024 prescaler 

    TIMSK0=0;


    // set up the ADC
    SFREQ=analogRead(0);
    ADCSRA &= ~PS_128;  // remove bits set by Arduino library
    // Choose prescaler PS_128.
    ADCSRA |= PS_128;
    ADMUX = 64;
    sbi(ADCSRA, ADSC);
         
}




void loop() {  

  uint16_t samplecntBD,samplecntBG2,samplecntCL,samplecntCW,samplecntCY,samplecntGU,samplecntMA,samplecntQU;

  samplecntBD=0;
  samplecntBG2=0;
  samplecntCL=0;
  samplecntCW=0;
  samplecntCY=0;
  samplecntGU=0;
  samplecntMA=0;
  samplecntQU=0;

  uint16_t samplepntBD,samplepntBG2,samplepntCL,samplepntCW,samplepntCY,samplepntGU,samplepntMA,samplepntQU;
  
  int16_t total;

  uint8_t stepcnt=0;
  uint16_t tempo=3500;
  uint16_t tempocnt=1;
  uint8_t MUX=4;

  uint8_t patselect=13;
  uint8_t patlength=pgm_read_byte_near(patlen + patselect);
  
  while(1) { 

    //------ Add current sample word to ringbuffer FIFO --------------------  
        
    if (RingCount<255) {  //if space in ringbuffer
      total=0;
      if (samplecntBD) {
        total+=(pgm_read_byte_near(BD + samplepntBD++)-128);
        samplecntBD--;
      }
      if (samplecntBG2) {
        total+=(pgm_read_byte_near(BG2 + samplepntBG2++)-128);
        samplecntBG2--;
      }
      if (samplecntCL) {
        total+=(pgm_read_byte_near(CL + samplepntCL++)-128);
        samplecntCL--;
      }
      if (samplecntCW) {
        total+=(pgm_read_byte_near(CW + samplepntCW++)-128);
        samplecntCW--;
      }
      if (samplecntCY) {
        total+=(pgm_read_byte_near(CY + samplepntCY++)-128);
        samplecntCY--;
      }
      if (samplecntGU) {
        total+=(pgm_read_byte_near(GU + samplepntGU++)-128);
        samplecntGU--;
      }
       if (samplecntMA) {
        total+=(pgm_read_byte_near(MA + samplepntMA++)-128);
        samplecntMA--;
      }
      if (samplecntQU) {
        total+=(pgm_read_byte_near(QU + samplepntQU++)-128);
        samplecntQU--;
      }
      if (total<-127) total=-127;
      if (total>127) total=127;                           
      cli();
      Ringbuffer[RingWrite]=total+128;
      RingWrite++;
      RingCount++;
      sei();
 

//----------------------------------------------------------------------------

//--------- sequencer block ----------------------------------------------
if (digitalReadFast(10)) {
  if (!(tempocnt--)) {
    tempocnt=tempo;
    digitalWriteFast(13,HIGH); //Clock out Hi
    uint8_t trig=pgm_read_byte_near(pattern + (patselect<<4) + stepcnt++);
    PORTC=stepcnt;
    uint8_t mask=(PIND>>2)|((PINB&3)<<6);
    trig&=mask;
    if (stepcnt>patlength) stepcnt=0;
    if (stepcnt==0) digitalWriteFast(12,HIGH); //Reset out Hi
    if (stepcnt!=0) digitalWriteFast(12,LOW); //Reset out Lo
    if (trig & 1) {
      samplepntQU=0;
      samplecntQU=7712;
    }
    if (trig & 2) {
      samplepntCY=0;
      samplecntCY=9434;
    }
    if (trig & 4) {
      samplepntMA=0;
      samplecntMA=568;
    }
    if (trig & 8) {
      samplepntCW=0;
      samplecntCW=830;
    }
    if (trig & 16) {
      samplepntCL=0;
      samplecntCL=752;
    }
    if (trig & 32) {
      samplepntBD=0;
      samplecntBD=1076;
    }
    if (trig & 64) {
      samplepntBG2=0;
      samplecntBG2=1136;
    }
    if (trig & 128) {
      samplepntGU=0;
      samplecntGU=2816;
    }
  }
  digitalWriteFast(13,LOW); //Clock out Lo
 }
}
if (!(digitalReadFast(10))) {
  digitalWriteFast(13,LOW); //Clock out Lo
  digitalWriteFast(12,LOW); //Reset out Lo
  PORTC=0;
  stepcnt=0;
  tempocnt=1
;}
//------------------------------------------------------------------------



//--------------- ADC block -------------------------------------
    if (!(ADCSRA & 64)) {

      uint16_t value=((ADCL+(ADCH<<8))>>3)+1;
      if (MUX==5) tempo=(value<<8)+1250;  //17633-1250
      if (MUX==4) patselect=(value-1)>>3;
      if (MUX==4) patlength=pgm_read_byte_near(patlen + patselect);
      
      MUX++;
      if (MUX==8) MUX=4;
      ADMUX = 64 | MUX; //Select MUX
      sbi(ADCSRA, ADSC); //start next conversation
    };
//---------------------------------------------------------------
    
  }
 
}

